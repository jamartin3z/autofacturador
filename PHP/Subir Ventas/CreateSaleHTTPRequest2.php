<?php
require_once 'HTTP/Request2.php';
$request = new HTTP_Request2();
$request->setUrl('https://autofacturador.cfdiquadrum.com.mx:8890/api/v1/order/create/');
$request->setMethod(HTTP_Request2::METHOD_POST);
$request->setConfig(array(
  'follow_redirects' => TRUE
));
$request->setHeader(array(
  'Merchant' => 'ID <MerchantID>',
  'Content-Type' => 'application/json',
  'Authorization' => 'Token <TokenID>'
));
$request->setBody('{\n    "concepts": [\n        {\n            "amount": "1443.40",\n            "description": "CONCEPTO 1",\n            "discount": 0.00,\n            "no_identification": "CONCEPTO 1",\n            "obj_imp": "02",\n            "quantity": "1",\n            "sat_key_product": "10171700",\n            "sat_key_unit": "H87",\n            "taxes": [\n                {\n                    "amount": "86.6038",\n                    "base": "1443.3963",\n                    "factor": "Tasa",\n                    "rate_or_fee": "0.060000",\n                    "tax": "003",\n                    "type": "T"\n                }\n            ],\n            "unit": "PIEZA",\n            "unit_price": "1443.40"\n        },\n        {\n            "amount": "653.27",\n            "description": "CONCEPTO 2",\n            "discount": 0.00,\n            "no_identification": "CONCEPTO 2",\n            "obj_imp": "02",\n            "quantity": "1",\n            "sat_key_product": "10171700",\n            "sat_key_unit": "H87",\n            "taxes": [\n                {\n                    "amount": "45.7290",\n                    "base": "653.2711",\n                    "factor": "Tasa",\n                    "rate_or_fee": "0.070000",\n                    "tax": "003",\n                    "type": "T"\n                },\n                {\n                    "amount": "345.32",\n                    "base": "6474.81",\n                    "factor": "Tasa",\n                    "rate_or_fee": "0.053333",\n                    "tax": "002",\n                    "type": "R"\n                }\n            ],\n            "unit": "PIEZA",\n            "unit_price": "653.27"\n        },\n        {\n            "amount": "233.95",\n            "description": "CONCEPTO 3",\n            "discount": 0.00,\n            "no_identification": "CONCEPTO 3",\n            "obj_imp": "02",\n            "quantity": "1",\n            "sat_key_product": "10171700",\n            "sat_key_unit": "H87",\n            "taxes": [\n                {\n                    "amount": "21.0551",\n                    "base": "233.9450",\n                    "factor": "Tasa",\n                    "rate_or_fee": "0.090000",\n                    "tax": "003",\n                    "type": "T"\n                },\n                {\n                    "amount": "647.48",\n                    "base": "6474.81",\n                    "factor": "Tasa",\n                    "rate_or_fee": "0.100000",\n                    "tax": "001",\n                    "type": "R"\n                }\n            ],\n            "unit": "PIEZA",\n            "unit_price": "233.94"\n        },\n        {\n            "amount": "6673.00",\n            "description": "CONCEPTO 4",\n            "discount": 0.00,\n            "no_identification": "CONCEPTO 4",\n            "obj_imp": "02",\n            "quantity": "1",\n            "sat_key_product": "10171700",\n            "sat_key_unit": "H87",\n            "taxes": [\n                {\n                    "amount": "0.0000",\n                    "base": "6673.0000",\n                    "factor": "Tasa",\n                    "rate_or_fee": "0.000000",\n                    "tax": "002",\n                    "type": "T"\n                }\n            ],\n            "unit": "PIEZA",\n            "unit_price": "6673.00"\n        },\n        {\n            "amount": "1623.28",\n            "description": "CONCEPTO 5",\n            "discount": 0.00,\n            "no_identification": "CONCEPTO 5",\n            "obj_imp": "02",\n            "quantity": "1",\n            "sat_key_product": "10171700",\n            "sat_key_unit": "H87",\n            "taxes": [\n                {\n                    "amount": "259.7241",\n                    "base": "1623.2759",\n                    "factor": "Tasa",\n                    "rate_or_fee": "0.160000",\n                    "tax": "002",\n                    "type": "T"\n                }\n            ],\n            "unit": "PIEZA",\n            "unit_price": "1623.28"\n        },\n        {\n            "amount": "1443.40",\n            "description": "CONCEPTO 6",\n            "discount": 0.00,\n            "no_identification": "CONCEPTO 6",\n            "obj_imp": "02",\n            "quantity": "1",\n            "sat_key_product": "10171700",\n            "sat_key_unit": "H87",\n            "taxes": [\n                {\n                    "amount": "86.6038",\n                    "base": "1443.3963",\n                    "factor": "Tasa",\n                    "rate_or_fee": "0.060000",\n                    "tax": "003",\n                    "type": "T"\n                }\n            ],\n            "unit": "PIEZA",\n            "unit_price": "1443.40"\n        },\n        {\n            "amount": "653.27",\n            "description": "CONCEPTO 7",\n            "discount": 0.00,\n            "no_identification": "CONCEPTO 7",\n            "obj_imp": "02",\n            "quantity": "1",\n            "sat_key_product": "10171700",\n            "sat_key_unit": "H87",\n            "taxes": [\n                {\n                    "amount": "45.7290",\n                    "base": "653.2711",\n                    "factor": "Tasa",\n                    "rate_or_fee": "0.070000",\n                    "tax": "003",\n                    "type": "T"\n                }\n            ],\n            "unit": "PIEZA",\n            "unit_price": "653.27"\n        },\n        {\n            "amount": "233.95",\n            "description": "CONCEPTO 8",\n            "discount": 0.00,\n            "no_identification": "CONCEPTO 8",\n            "obj_imp": "02",\n            "quantity": "1",\n            "sat_key_product": "10171700",\n            "sat_key_unit": "H87",\n            "taxes": [\n                {\n                    "amount": "21.0551",\n                    "base": "233.9450",\n                    "factor": "Tasa",\n                    "rate_or_fee": "0.090000",\n                    "tax": "003",\n                    "type": "T"\n                }\n            ],\n            "unit": "PIEZA",\n            "unit_price": "233.94"\n        },\n        {\n            "amount": "6673.00",\n            "description": "CONCEPTO 9",\n            "discount": 0.00,\n            "no_identification": "CONCEPTO 9",\n            "obj_imp": "02",\n            "quantity": "1",\n            "sat_key_product": "10171700",\n            "sat_key_unit": "H87",\n            "taxes": [\n                {\n                    "amount": "0.0000",\n                    "base": "6673.0000",\n                    "factor": "Tasa",\n                    "rate_or_fee": "0.000000",\n                    "tax": "002",\n                    "type": "T"\n                }\n            ],\n            "unit": "PIEZA",\n            "unit_price": "6673.00"\n        },\n        {\n            "amount": "1623.28",\n            "description": "CONCEPTO 10",\n            "discount": 0.00,\n            "no_identification": "CONCEPTO 10",\n            "obj_imp": "02",\n            "quantity": "1",\n            "sat_key_product": "10171700",\n            "sat_key_unit": "H87",\n            "taxes": [\n                {\n                    "amount": "259.7241",\n                    "base": "1623.2759",\n                    "factor": "Tasa",\n                    "rate_or_fee": "0.160000",\n                    "tax": "002",\n                    "type": "T"\n                }\n            ],\n            "unit": "PIEZA",\n            "unit_price": "1623.28"\n        }\n    ],\n    "date": "2023-03-22T10:48:50",\n    "total": 21087.23,\n    "order_id": "GbjPWMSQOL002",\n    "folio": "lpNUBnzbue002",\n    "serial": "qD3608576030002"\n}');
try {
  $response = $request->send();
  if ($response->getStatus() == 200) {
    echo $response->getBody();
  }
  else {
    echo 'Unexpected HTTP status: ' . $response->getStatus() . ' ' .
    $response->getReasonPhrase();
  }
}
catch(HTTP_Request2_Exception $e) {
  echo 'Error: ' . $e->getMessage();
}

?>